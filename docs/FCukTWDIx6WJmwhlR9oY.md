---
title: Fetching app data
---

<div align="center">    <br/>    <div>DOC</div>    <h1>Fetching app data</h1>    <br/>  </div>

### Files Used:
📄 src/app/common/components/App.vue

📄 src/app/common/mixins/storeModulesWrapper.js

📄 src/app/common/pages/ExercisePage.vue


<br/>

When the swimmer starts the `swimm` app, there are two main sources of data the app uses:

*   In all of the pages - the online database (Firebase Firestore), such as workspaces and upvotes.
    
*   Local repo files - when inside a repo route: the files inside in the `.swm` directory
    

Each page is responsible to fetch the data it needs in the stores, if the data is already in the store then the view will just get it from the store.

<br/>

On every app load or refresh we load “default” data (workspaces, upvotes..) as long as the user is signed in and in a valid route.

<div>    📄 src/app/common/components/App.vue  </div>

```js
⬜ 44           handler: async function (newUser, oldUser) {
⬜ 45             if (!oldUser && newUser && this.$route.fullPath !== '/404') {
⬜ 46               this.loading = true;
🟩 47               await this.setDefaultAppData();
⬜ 48               this.loading = false;
⬜ 49             } else if (oldUser && !newUser) {
⬜ 50               //TODO: unsubscribe all open subscriptions
```
<br/>

In `src/app/common/mixins/storeModulesWrapper.js ✓` we have multiple data initialize functions to be used by the views to load required data.
e.g `setUnitData` can be called on each view that need a specific exercise/doc data. the function loads the local unit `swm` file.

<div>    📄 src/app/common/mixins/storeModulesWrapper.js  </div>

```js
⬜ 159          await this.fetchDomainSettings();
⬜ 160          await this.fetchUserUpvotes({ userId: this.user.uid });
⬜ 161        },
🟩 162        async setUnitData() {
🟩 163          try {
🟩 164            if (this.$route.params.unitId && !['new', DEMO_CONTENT_IDS.EXAMPLE_DOC_ID].includes(this.$route.params.unitId)) {
🟩 165              await this.loadLocalSwmFile({ unitId: this.$route.params.unitId, repoId: this.$route.params.repoId, shouldAutofix: true });
🟩 166            }
🟩 167          } catch (error) {
🟩 168            console.error('The app failed to fetch the unit swm file:', error);
🟩 169          }
🟩 170        },
⬜ 171        async setPlayListData() {
⬜ 172          try {
⬜ 173            if (this.$route.params.repoId === SWIMM_PUBLIC_CONTENT_REPO_ID) {
```
<br/>

In this step we calls `setUnitData` to load the exercise data and display it in the exercise page.

<div>    📄 src/app/common/pages/ExercisePage.vue  </div>

```js
⬜ 48         if (!assertResult) {
⬜ 49           return;
⬜ 50         }
🟩 51         await this.setUnitData();
⬜ 52         this.swm = this.getUnitFromLocalRepo(this.$route.params.unitId, this.$route.params.repoId);
⬜ 53         this.assertActualExercise();
⬜ 54         this.loading = false;
```
<br/>

In this step we added the `setHomeData` function that will be called from the home page. This function load a lot of data, luckily this data will be reused across the app and will be fetched only once.

<div>    📄 src/app/common/mixins/storeModulesWrapper.js  </div>

```js
⬜ 219            console.error('The app failed to fetch all repos data:', error);
⬜ 220          }
⬜ 221        },
🟩 222        async setHomeData() {
🟩 223          try {
🟩 224            await this.setSwimmPublicPlaylist();
🟩 225            await this.fetchSwimmerRepos({ uid: this.user.uid });
🟩 226            await this.fetchOpenSourceRepos();
🟩 227            await this.fetchSwimmerWorkspaces();
🟩 228            await this.fetchAllWorkspacesRepos();
🟩 229            await this.fetchWorkspaceInvites();
🟩 230            await this.fetchDismissedWorkspaceInvites();
🟩 231          } catch (error) {
🟩 232            console.error('The app failed to fetch all repos data:', error);
🟩 233          }
🟩 234        },
⬜ 235        async setSwimmPublicPlaylist() {
⬜ 236          // fetch swimm "get started" public playlist
⬜ 237          const repoId = SWIMM_PUBLIC_CONTENT_REPO_ID;
```
<br/>

In general, once data is fetched / loaded, we store it in the state so most of the time we won't need to fetch / load it again. If for example you go to `/repos`, let it load, go to another page and come back to `/repos` (without reloading the app, e.g. by clicking the Swimm logo at the top left corner), you won't have to wait a second time.

<br/>

<br/><br/>

This file was generated by Swimm. [Click here to view it in the app](https://swimm.io/link?l=c3dpbW0lM0ElMkYlMkZyZXBvcyUyRnZlZXp2eEN1enBQclJMTFhXRDJFJTJGZG9jcyUyRkZDdWtUV0RJeDZXSm13aGxSOW9Z). Timestamp: 2021-04-24T18:52:02.114Z
