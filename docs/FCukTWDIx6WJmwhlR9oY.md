---
title: Fetching app data
---

<div align="center">    <br/>    <div>DOC</div>    <h1>Fetching app data</h1>    <br/>  </div>

### Files Used:
ğŸ“„ src/app/common/components/App.vue

ğŸ“„ src/app/common/mixins/storeModulesWrapper.js

ğŸ“„ src/app/common/pages/ExercisePage.vue


<br/>

When the swimmer starts the `swimm` app, there are two main sources of data the app uses:

*   In all of the pages - the online database (Firebase Firestore), such as workspaces and upvotes.
    
*   Local repo files - when inside a repo route: the files inside in the `.swm` directory
    

Each page is responsible to fetch the data it needs in the stores, if the data is already in the store then the view will just get it from the store.

<br/>

On every app load or refresh we load â€œdefaultâ€ data (workspaces, upvotes..) as long as the user is signed in and in a valid route.

<div>    ğŸ“„ src/app/common/components/App.vue  </div>

```js
â¬œ 44           handler: async function (newUser, oldUser) {
â¬œ 45             if (!oldUser && newUser && this.$route.fullPath !== '/404') {
â¬œ 46               this.loading = true;
ğŸŸ© 47               await this.setDefaultAppData();
â¬œ 48               this.loading = false;
â¬œ 49             } else if (oldUser && !newUser) {
â¬œ 50               //TODO: unsubscribe all open subscriptions
```
<br/>

In `src/app/common/mixins/storeModulesWrapper.js âœ“` we have multiple data initialize functions to be used by the views to load required data.
e.g `setUnitData` can be called on each view that need a specific exercise/doc data. the function loads the local unit `swm` file.

<div>    ğŸ“„ src/app/common/mixins/storeModulesWrapper.js  </div>

```js
â¬œ 159          await this.fetchDomainSettings();
â¬œ 160          await this.fetchUserUpvotes({ userId: this.user.uid });
â¬œ 161        },
ğŸŸ© 162        async setUnitData() {
ğŸŸ© 163          try {
ğŸŸ© 164            if (this.$route.params.unitId && !['new', DEMO_CONTENT_IDS.EXAMPLE_DOC_ID].includes(this.$route.params.unitId)) {
ğŸŸ© 165              await this.loadLocalSwmFile({ unitId: this.$route.params.unitId, repoId: this.$route.params.repoId, shouldAutofix: true });
ğŸŸ© 166            }
ğŸŸ© 167          } catch (error) {
ğŸŸ© 168            console.error('The app failed to fetch the unit swm file:', error);
ğŸŸ© 169          }
ğŸŸ© 170        },
â¬œ 171        async setPlayListData() {
â¬œ 172          try {
â¬œ 173            if (this.$route.params.repoId === SWIMM_PUBLIC_CONTENT_REPO_ID) {
```
<br/>

In this step we calls `setUnitData` to load the exercise data and display it in the exercise page.

<div>    ğŸ“„ src/app/common/pages/ExercisePage.vue  </div>

```js
â¬œ 48         if (!assertResult) {
â¬œ 49           return;
â¬œ 50         }
ğŸŸ© 51         await this.setUnitData();
â¬œ 52         this.swm = this.getUnitFromLocalRepo(this.$route.params.unitId, this.$route.params.repoId);
â¬œ 53         this.assertActualExercise();
â¬œ 54         this.loading = false;
```
<br/>

In this step we added the `setHomeData` function that will be called from the home page. This function load a lot of data, luckily this data will be reused across the app and will be fetched only once.

<div>    ğŸ“„ src/app/common/mixins/storeModulesWrapper.js  </div>

```js
â¬œ 219            console.error('The app failed to fetch all repos data:', error);
â¬œ 220          }
â¬œ 221        },
ğŸŸ© 222        async setHomeData() {
ğŸŸ© 223          try {
ğŸŸ© 224            await this.setSwimmPublicPlaylist();
ğŸŸ© 225            await this.fetchSwimmerRepos({ uid: this.user.uid });
ğŸŸ© 226            await this.fetchOpenSourceRepos();
ğŸŸ© 227            await this.fetchSwimmerWorkspaces();
ğŸŸ© 228            await this.fetchAllWorkspacesRepos();
ğŸŸ© 229            await this.fetchWorkspaceInvites();
ğŸŸ© 230            await this.fetchDismissedWorkspaceInvites();
ğŸŸ© 231          } catch (error) {
ğŸŸ© 232            console.error('The app failed to fetch all repos data:', error);
ğŸŸ© 233          }
ğŸŸ© 234        },
â¬œ 235        async setSwimmPublicPlaylist() {
â¬œ 236          // fetch swimm "get started" public playlist
â¬œ 237          const repoId = SWIMM_PUBLIC_CONTENT_REPO_ID;
```
<br/>

In general, once data is fetched / loaded, we store it in the state so most of the time we won't need to fetch / load it again. If for example you go to `/repos`, let it load, go to another page and come back to `/repos` (without reloading the app, e.g. by clicking the Swimm logo at the top left corner), you won't have to wait a second time.

<br/>

<br/><br/>

This file was generated by Swimm. [Click here to view it in the app](https://swimm.io/link?l=c3dpbW0lM0ElMkYlMkZyZXBvcyUyRnZlZXp2eEN1enBQclJMTFhXRDJFJTJGZG9jcyUyRkZDdWtUV0RJeDZXSm13aGxSOW9Z). Timestamp: 2021-04-24T18:52:02.114Z
